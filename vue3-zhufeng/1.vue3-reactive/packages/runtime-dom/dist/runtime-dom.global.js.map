{"version":3,"file":"runtime-dom.global.js","sources":["../../shared/src/index.ts","../src/nodeOps.ts","../src/modules/attr.ts","../src/modules/class.ts","../src/modules/events.ts","../src/modules/style.ts","../src/patchProp.ts","../../runtime-core/src/renderer.ts","../src/index.ts"],"sourcesContent":["export const isObject = (value) => typeof value == 'object' && value !== null;\nexport const extend = Object.assign\nexport const isArray = Array.isArray;\nexport const isFunction = (value) => typeof value == 'function'\nexport const isNumber = (value) => typeof value == 'number';\nexport const isString = (value) => typeof value === 'string';\nexport const isIntegerKey = (key) => parseInt(key) + '' === key;\n\n\nlet hasOwnpRroperty = Object.prototype.hasOwnProperty;\nexport const hasOwn = (target, key) => hasOwnpRroperty.call(target, key);\n\nexport const hasChanged = (oldValue,value) => oldValue !== value\nconst shared = {}\n\nexport default shared;\n","export const nodeOps = {\n  createElement: tagName => document.createElement(tagName),\n  remove: child => {// 删除\n      const parent = child.parentNode;\n      if(parent){\n        parent.removeChild(child)\n      }\n  },\n  insert: (child, parent, anchor = null) => {\n    parent.insertBefore(child, anchor); // \n  },\n  querySelector: selector => document.querySelector(selector),\n  setElementText: (el, text) => el.textContent = text,\n  createText: text => document.createTextNode(text),\n  setText: (node, text) => node.nodeValue = text\n}","\n\nexport const patchAttr = (el,key,value) =>{\n  if(value == null){\n      el.removeAttribute(key);\n  }else {\n      el.setAttribute(key,value);\n  }\n}","export const patchClass = (el ,value) => {\n  if(value == null){\n    value = ''\n  }\n  el.className = value\n}\n","export const patchEvent = (el, key, value) => {\n  // 对函数的缓存\n  const invokers = el._vei || (el._vei || {})\n  const exists = invokers[key]; // 如果不存在\n  if(value && exists){ // 更新绑定事件\n    exists.value = value;\n  }else{\n    const eventName = key.slice(2).toLowerCase()\n    if(value){ // 之前没有绑定过现在绑定\n      let invoker = invokers[key] = createInvoker(value);\n       el.addEventListener(eventName,invoker)\n    }else{\n      if(exists){ // 以前绑定了 当时没有value\n        el.removeEventListener(eventName,exists);\n        // invokers[key] = undefined;\n        delete invokers[key]\n      }\n    }\n  }\n}\n\nfunction createInvoker(value) {\n  const invoker = (e) => { invoker.value(e)} \n  invoker.value = value;\n  return invoker\n}","export const patchStyle = (el,prev,next) =>{ // cssText;\n  const style = el.style; //获取样式 \n  if(next == null){\n      el.removeAttribute('style') // {style:{}}  {}\n  }else{\n      // 老的里新的有没有 \n      if(prev){  // {style:{color}} => {style:{background}}\n          for(let key in prev){\n              if(next[key] == null){ // 老的里有 新的里没有 需要删除\n                  style[key] = '';\n              }\n          }\n      }\n      // 新的里面需要赋值到style上\n      for(let key in next){ // {style:{color}} => {style:{background}}\n          style[key] = next[key];\n      }\n  }\n\n}","import { patchAttr } from \"./modules/attr\";\nimport { patchClass } from \"./modules/class\";\nimport { patchEvent } from \"./modules/events\";\nimport { patchStyle } from \"./modules/style\";\n\n// 这个里面针对的是属性操作\nexport const patchProp = (el, key, preValue, nextValue) => {\n  switch (key) {\n    case \"class\":\n      patchClass(el, nextValue); // 比对属性\n      break;\n    case \"style\": // {style:{color:'red'}}  {style:{background:'red'}}\n      patchStyle(el, preValue, nextValue);\n      break;\n    default:\n      // 如果不是事件 才是属性\n      if (/^on[^a-z]/.test(key)) {\n        patchEvent(el, key, nextValue); // 事件就是添加和删除 修改\n      } else {\n        patchAttr(el, key, nextValue);\n      }\n\n      break;\n  }\n};\n","export function createRenderer(rendererOptions) { // 告诉core 怎么渲染\n  return {\n    createApp: (rootComponent,rootProps) => {}\n  }\n}\n","// runtime-dom 核心就是  提供domAPI方法了\n//操作节点、操作属性的更新\n// 节点操作就是增删改查 \n// 属性操作 添加 删除 更新 (样式、类、事件、其他属性)\nimport { extend } from \"@vue/shared/src\";\nimport { nodeOps } from \"./nodeOps\"; // 对象\nimport { patchProp } from \"./patchProp\"; // 方法\nimport { createRenderer } from '@vue/runtime-core/src'\n\n\n// 渲染时用到的所有方法\nconst rendererOptions = extend({ patchProp }, nodeOps)\n\n// vue中runtime-core 提供了核心的方法 用来处理渲染的，他会使用runtime-dom中的api进行渲染\nexport function createApp(rootComponent, rootProps = null) {\n  const app: any = createRenderer(rendererOptions).createApp(rootComponent,rootProps)\n  // let {mount} = app\n  app.mount = function (container) {\n      // // 清空容器的操作 \n      // container = nodeOps.querySelector(container);\n      // container.innerHTML = '';\n      // mount(container); // 函数劫持\n      // // 将组件 渲染成dom元素 进行挂载\n  }\n  return app;\n}\n\nexport default {}"],"names":[],"mappings":"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"}